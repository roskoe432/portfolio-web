#!/bin/sh
set -e

echo "Checking current git branch..."

BRANCH="$(git rev-parse --abbrev-ref HEAD)"

if [ "$BRANCH" = "main" ] || [ "$BRANCH" = "master" ]; then
  echo "----------------------------------------------------"
  echo "ERROR: Direct commits to '$BRANCH' branch are not allowed."
  echo "Please create a feature/fix branch and use a pull request."
  echo "----------------------------------------------------"
  exit 1
fi

echo "Running lint checks..."
npm run lint

echo "Running format checks..."
npm run format:check

echo "Running tests..."
npm run test

echo "All checks passed. Proceeding with commit."
