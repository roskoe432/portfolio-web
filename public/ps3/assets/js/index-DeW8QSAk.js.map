{"version":3,"file":"index-DeW8QSAk.js","sources":["../../../src/lib/beads.js","../../../src/lib/state-machine.js","../../../src/lib/utils.js","../../../src/lib/player.js","../../../src/game.js"],"sourcesContent":["export function DrawWallBead(x, y) {\n  const shade = 65;\n  PS.border(x, y, 10);\n  PS.borderColor(x, y, [shade * 1, shade * 1, shade * 1]);\n  PS.scale(x, y, 80);\n  PS.bgColor(x, y, PS.COLOR_BLACK);\n  PS.bgAlpha(x, y, 255);\n  PS.color(x, y, [shade * 2, shade * 2, shade * 2]);\n  PS.data(x, y, { type: 'wall', tag: '|' });\n}\n\nexport function DrawFloorBead(x, y, hasKey = false) {\n    PS.border(x, y, 2);\n    PS.borderColor(x, y, PS.COLOR_BLACK);\n    PS.scale(x, y, 100);\n    PS.bgColor(x, y, PS.COLOR_GRAY);\n    PS.bgAlpha(x, y, 255);\n    PS.color(x, y, [200, 200, 200]);\n\n    const floorData = { type: 'floor', tag: '_' };\n  \n    if (hasKey) {\n        PS.glyph(x, y, \"★\");\n        PS.glyphColor(x, y, PS.COLOR_YELLOW);\n        floorData.hasKey = true;\n        floorData.onEnter = () => {\n            PS.glyph(x, y, \"\");\n        }\n    }\n\n    PS.data(x, y, floorData);\n}\n\nexport function DrawDoorBead(x, y) {\n    PS.border(x, y, 4);\n    PS.borderColor(x, y, PS.COLOR_BLACK);\n    PS.color(x, y, [139, 69, 19]); // Brown color\n    const data = { type: 'door', tag: 'D', skipRedraw: true };\n    \n    data.onEnter = () => {\n        console.log(`Door on entered at (${x}, ${y})`);\n        DrawFloorBead(x, y);\n    }\n\n    PS.data(x, y, data);\n}\n\nexport function DrawFinalBead(x, y) {\n    PS.border(x, y, 4);\n    PS.borderColor(x, y, PS.COLOR_BLACK);\n    PS.color(x, y, PS.COLOR_GREEN);\n    PS.data(x, y, { type: 'final', tag: '+' });\n}\n\nconst registry = {\n    '|': DrawWallBead,\n    '_': DrawFloorBead,\n    'K': (x, y) => DrawFloorBead(x, y, true),\n    'D': DrawDoorBead,\n    '+': DrawFinalBead,\n};\n\nconst drawMap = (map) => {\n    for (let y = 0; y < map.length; y++) {\n        for (let x = 0; x < map[y].length; x++) {\n            const cell = map[y][x];\n            const beadFunction = registry[cell];\n            if (beadFunction) {\n                beadFunction(x, y);\n            }\n        }\n    }\n};\n\nexport const level1 = [\n    ['|', '|', '|', '|', '|', '|', '|', '|'],\n    ['|', '_', '_', '_', '_', '_', '_', '|'],\n    ['|', '_', '|', '|', '|', '|', '_', '|'],\n    ['|', '_', '|', '_', '+', '|', '_', '|'],\n    ['|', '_', 'D', '_', '_', '|', '_', '|'],\n    ['|', '_', '|', '|', '|', '|', '_', '|'],\n    ['|', '_', '_', '_', '_', '_', 'K', '|'],\n    ['|', '|', '|', '|', '|', '|', '|', '|'],\n];\n\nexport default drawMap;\n","\nfunction StateMachine() {\n    this.states = new Map();\n    this.currentState = null;\n\n    this.addState = function(name, stateFn) {\n        if (this.states.has(name)) {\n            throw new Error(`State \"${name}\" already exists.`);\n        }\n        this.states.set(name, stateFn);\n    };\n\n    this.setState = function(name) {\n        if (!this.states.has(name)) {\n            throw new Error(`State \"${name}\" does not exist.`);\n        }\n        console.log(`${this.currentState} --> ${name}\\n`);\n        this.currentState = name;\n    };\n\n    this.invoke = function(...args) {\n        if (!this.currentState) {\n            throw new Error(\"No current state set.\");\n        }\n        const stateFn = this.states.get(this.currentState);\n        return stateFn(...args);\n    };\n\n    this.setAndInvoke = function(name, ...args) {\n        this.setState(name);\n        return this.invoke(...args);\n    }\n}\n\nexport default StateMachine;\n","\nconst beadDrawFns = [\n    // Allowed PS bead drawing functions\n    'color',\n    'bgColor',\n    'bgAlpha',\n    'border',\n    'borderColor',\n    'scale',\n    'data',\n];\n\nconst Keycode = {\n    UP: 1006,\n    RIGHT: 1007,\n    DOWN: 1008,\n    LEFT: 1005,\n};\n\nexport function getDrawFnResults(x, y) {\n    return beadDrawFns.reduce((acc, fn) => {\n        acc[fn] = PS[fn](x, y);\n        return acc;\n    }, {});\n}\n\nexport function redrawBead(x, y, drawData) {\n    for (const fn of beadDrawFns) {\n        if (drawData.hasOwnProperty(fn)) {\n            PS[fn](x, y, drawData[fn]);\n        }\n    }\n}\n\nexport function clearBoard() {\n    const width = PS.gridSize().width;\n    const height = PS.gridSize().height;\n\n    for (let x = 0; x < width; x++) {\n        for (let y = 0; y < height; y++) {\n            beadDrawFns.forEach((fn) => {\n                PS[fn](x, y, PS.DEFAULT);\n            });\n        }\n    }\n\n    PS.statusText(\"\");\n    PS.gridRefresh();\n}\n\nexport function getDirectionFromKeycode(keycode) {\n    switch (keycode) { \n        case Keycode.UP:\n            return { x: 0, y: -1 };\n        case Keycode.RIGHT:\n            return { x: 1, y: 0 };\n        case Keycode.DOWN:\n            return { x: 0, y: 1 };\n        case Keycode.LEFT:\n            return { x: -1, y: 0 };\n        default:\n            return null;\n    }\n}\n","import StateMachine from \"./state-machine\";\nimport { getDirectionFromKeycode, getDrawFnResults, redrawBead } from \"./utils\";\n\nconst PlayerState = {\n  IDLE: \"idle\",\n  CHECK_MOVE: \"checkMove\",\n  MOVING: \"moving\",\n  HIT_WALL: \"hitWall\",\n  KEY_PICKUP: \"keyPickup\",\n  DOOR_INTERACTION: \"doorInteraction\",\n  WIN: \"win\",\n};\n\nconst Sfx = {\n  MOVE: \"fx_bloop\",\n  HIT_WALL: \"fx_bucket\",\n  KEY_PICKUP: \"fx_coin1\",\n  DOOR_OPEN: \"fx_squink\",\n  WIN: \"fx_tada\",\n};\n\nfunction Player(name, onWin) {\n  const fsm = new StateMachine();\n  let _tenantData = null;\n  let listening = false;\n\n  this.name = name;\n  this.x = 1;\n  this.y = 1;\n  this.startX = 1;\n  this.startY = 1;\n  this.keys = 0;\n\n  const drawAt = (x, y) => {\n    if (_tenantData && !_tenantData.skipRedraw) {\n      redrawBead(this.x, this.y, _tenantData);\n    }\n\n    this.x = x;\n    this.y = y;\n\n    _tenantData = getDrawFnResults(x, y);\n\n    PS.color(x, y, PS.COLOR_YELLOW);\n    PS.scale(x, y, 90);\n    PS.data(x, y, { type: \"player\" });\n  };\n\n  const stateIdle = (data) => {\n    if (!data) {\n      return;\n    }\n\n    const { newX, newY } = data;\n    if (!PS.data(newX, newY)) {\n      return;\n    }\n\n    fsm.setAndInvoke(PlayerState.CHECK_MOVE, data);\n  };\n\n  const stateCheckMove = (data) => {\n    const { newX, newY } = data;\n    const beadData = PS.data(newX, newY);\n\n    if (!beadData || beadData.type === \"wall\") {\n      return fsm.setAndInvoke(PlayerState.HIT_WALL, data);\n    }\n\n    if (beadData.type === \"door\") {\n      return fsm.setAndInvoke(PlayerState.DOOR_INTERACTION, data);\n    }\n\n    if (beadData.type === \"floor\" && beadData.hasKey) {\n      return fsm.setAndInvoke(PlayerState.KEY_PICKUP, data);\n    }\n\n    if (beadData.type === \"final\") {\n      return fsm.setAndInvoke(PlayerState.WIN, data);\n    }\n\n    fsm.setAndInvoke(PlayerState.MOVING, data);\n  };\n\n  const stateKeyPickup = ({newX, newY}) => {\n    const beadData = PS.data(newX, newY);\n    this.keys += 1;\n    PS.audioPlay(Sfx.KEY_PICKUP);\n    beadData.hasKey = false;\n    fsm.setAndInvoke(PlayerState.MOVING, { newX, newY }) ;\n  };\n\n  const stateHitWall = (data) => {\n    PS.audioPlay(Sfx.HIT_WALL);\n    fsm.setAndInvoke(PlayerState.IDLE);\n  };\n\n  const stateDoorInteraction = (data) => {\n    if (this.keys > 0) {\n      PS.audioPlay(Sfx.DOOR_OPEN);\n      this.keys -= 1;\n      return fsm.setAndInvoke(PlayerState.MOVING, data);\n    }\n\n    PS.audioPlay(Sfx.HIT_WALL);\n    return fsm.setAndInvoke(PlayerState.HIT_WALL, data);\n  };\n\n  const stateWin = (data) => {\n    listening = false;\n    drawAt(data.newX, data.newY);\n    PS.audioPlay(Sfx.WIN);\n    PS.statusColor(PS.COLOR_GREEN);\n    PS.statusText(\"You Win!\");\n  };\n\n  const stateMoving = ({ newX, newY }) => {\n    const beadData = PS.data(newX, newY);\n    if (beadData.onEnter) {\n      beadData.onEnter(this);\n    }\n\n    PS.audioPlay(Sfx.MOVE);\n    drawAt(newX, newY);\n\n    fsm.setAndInvoke(PlayerState.IDLE);\n  };\n\n  this.listenForInput = function (ev) {\n    if (!listening) return;\n\n    const direction = getDirectionFromKeycode(ev.key);\n\n    if (direction) {\n      const newX = this.x + direction.x;\n      const newY = this.y + direction.y;\n      fsm.invoke({ newX, newY });\n    }\n  };\n\n  this.init = function (x, y) {\n    fsm.addState(PlayerState.IDLE, stateIdle);\n    fsm.addState(PlayerState.CHECK_MOVE, stateCheckMove);\n    fsm.addState(PlayerState.KEY_PICKUP, stateKeyPickup);\n    fsm.addState(PlayerState.DOOR_INTERACTION, stateDoorInteraction);\n    fsm.addState(PlayerState.HIT_WALL, stateHitWall);\n    fsm.addState(PlayerState.MOVING, stateMoving);\n    fsm.addState(PlayerState.WIN, stateWin);\n    fsm.setState(PlayerState.IDLE);\n\n    Object.keys(Sfx).forEach((sfxKey) => {\n      PS.audioLoad(Sfx[sfxKey], { lock: true });\n    });\n\n    const beadData = PS.data(x, y);\n    if (!beadData) {\n      throw new Error(`Invalid start position (${x}, ${y}): out of bounds or map data missing.`);\n    }\n\n    this.startX = x;\n    this.startY = y;\n\n    drawAt(x, y);\n\n    listening = true;\n  };\n}\n\nexport default Player;\n","/*\r\ngame.js for Perlenspiel 3.3.x\r\nLast revision: 2022-03-15 (BM)\r\n\r\nPerlenspiel is a scheme by Professor Moriarty (bmoriarty@wpi.edu).\r\nThis version of Perlenspiel (3.3.x) is hosted at <https://ps3.perlenspiel.net>\r\nPerlenspiel is Copyright © 2009-22 Brian Moriarty.\r\nThis file is part of the standard Perlenspiel 3.3.x devkit distribution.\r\n\r\nPerlenspiel is free software: you can redistribute it and/or modify\r\nit under the terms of the GNU Lesser General Public License as published\r\nby the Free Software Foundation, either version 3 of the License, or\r\n(at your option) any later version.\r\n\r\nPerlenspiel is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\r\nGNU Lesser General Public License for more details.\r\n\r\nYou may have received a copy of the GNU Lesser General Public License\r\nalong with the Perlenspiel devkit. If not, see <http://www.gnu.org/licenses/>.\r\n*/\r\n\r\n/*\r\nThis JavaScript file is a template for creating new Perlenspiel 3.3.x games.\r\nAny unused event-handling function templates can be safely deleted.\r\nRefer to the tutorials and documentation at <https://ps3.perlenspiel.net> for details.\r\n*/\r\n\r\n/*\r\nThe following comment lines are for JSHint <https://jshint.com>, a tool for monitoring code quality.\r\nYou may find them useful if your development environment is configured to support JSHint.\r\nIf you don't use JSHint (or are using it with a configuration file), you can safely delete these two lines.\r\n*/\r\n\r\n/* jshint browser : true, devel : true, esversion : 6, freeze : true */\r\n/* globals PS : true */\r\n\r\n\"use strict\"; // Do NOT remove this directive!\r\n\r\nimport drawMap, { level1 } from '@/lib/beads.js';\r\nimport Player from './lib/player';\r\nimport './game.css';\r\nimport { clearBoard } from './lib/utils';\r\n\r\nlet player = new Player('Link');\r\n\r\nPS.init = function( system, options ) {\r\n\tPS.gridSize( 8, 8 );\r\n    PS.gridColor( PS.COLOR_BLACK );\r\n    PS.gridShadow( true, PS.COLOR_WHITE );\r\n\tPS.statusText(\"Doors & Keys\" );\r\n\r\n    drawMap(level1);\r\n\r\n    player.init(1, 1);\r\n};\r\n\r\n/*\r\nPS.touch ( x, y, data, options )\r\nCalled when the left mouse button is clicked over bead(x, y), or when bead(x, y) is touched.\r\nThis function doesn't have to do anything. Any value returned is ignored.\r\n[x : Number] = zero-based x-position (column) of the bead on the grid.\r\n[y : Number] = zero-based y-position (row) of the bead on the grid.\r\n[data : *] = The JavaScript value previously associated with bead(x, y) using PS.data(); default = 0.\r\n[options : Object] = A JavaScript object with optional data properties; see API documentation for details.\r\n*/\r\n\r\nPS.touch = function( x, y, data, options ) {\r\n\t// Uncomment the following code line\r\n\t// to inspect x/y parameters:\r\n\r\n\t// PS.debug( \"PS.touch() @ \" + x + \", \" + y + \"\\n\" );\r\n\r\n\t// Add code here for mouse clicks/touches\r\n\t// over a bead.\r\n};\r\n\r\n/*\r\nPS.release ( x, y, data, options )\r\nCalled when the left mouse button is released, or when a touch is lifted, over bead(x, y).\r\nThis function doesn't have to do anything. Any value returned is ignored.\r\n[x : Number] = zero-based x-position (column) of the bead on the grid.\r\n[y : Number] = zero-based y-position (row) of the bead on the grid.\r\n[data : *] = The JavaScript value previously associated with bead(x, y) using PS.data(); default = 0.\r\n[options : Object] = A JavaScript object with optional data properties; see API documentation for details.\r\n*/\r\n\r\nPS.release = function( x, y, data, options ) {\r\n\t// Uncomment the following code line to inspect x/y parameters:\r\n\r\n\t// PS.debug( \"PS.release() @ \" + x + \", \" + y + \"\\n\" );\r\n\r\n\t// Add code here for when the mouse button/touch is released over a bead.\r\n};\r\n\r\n/*\r\nPS.enter ( x, y, button, data, options )\r\nCalled when the mouse cursor/touch enters bead(x, y).\r\nThis function doesn't have to do anything. Any value returned is ignored.\r\n[x : Number] = zero-based x-position (column) of the bead on the grid.\r\n[y : Number] = zero-based y-position (row) of the bead on the grid.\r\n[data : *] = The JavaScript value previously associated with bead(x, y) using PS.data(); default = 0.\r\n[options : Object] = A JavaScript object with optional data properties; see API documentation for details.\r\n*/\r\n\r\nPS.enter = function( x, y, data, options ) {\r\n\t// Uncomment the following code line to inspect x/y parameters:\r\n\r\n\t// PS.debug( \"PS.enter() @ \" + x + \", \" + y + \"\\n\" );\r\n\r\n\t// Add code here for when the mouse cursor/touch enters a bead.\r\n};\r\n\r\n/*\r\nPS.exit ( x, y, data, options )\r\nCalled when the mouse cursor/touch exits bead(x, y).\r\nThis function doesn't have to do anything. Any value returned is ignored.\r\n[x : Number] = zero-based x-position (column) of the bead on the grid.\r\n[y : Number] = zero-based y-position (row) of the bead on the grid.\r\n[data : *] = The JavaScript value previously associated with bead(x, y) using PS.data(); default = 0.\r\n[options : Object] = A JavaScript object with optional data properties; see API documentation for details.\r\n*/\r\n\r\nPS.exit = function( x, y, data, options ) {\r\n\t// Uncomment the following code line to inspect x/y parameters:\r\n\r\n\t// PS.debug( \"PS.exit() @ \" + x + \", \" + y + \"\\n\" );\r\n\r\n\t// Add code here for when the mouse cursor/touch exits a bead.\r\n};\r\n\r\n/*\r\nPS.exitGrid ( options )\r\nCalled when the mouse cursor/touch exits the grid perimeter.\r\nThis function doesn't have to do anything. Any value returned is ignored.\r\n[options : Object] = A JavaScript object with optional data properties; see API documentation for details.\r\n*/\r\n\r\nPS.exitGrid = function( options ) {\r\n\t// Uncomment the following code line to verify operation:\r\n\r\n\t// PS.debug( \"PS.exitGrid() called\\n\" );\r\n\r\n\t// Add code here for when the mouse cursor/touch moves off the grid.\r\n};\r\n\r\n/*\r\nPS.keyDown ( key, shift, ctrl, options )\r\nCalled when a key on the keyboard is pressed.\r\nThis function doesn't have to do anything. Any value returned is ignored.\r\n[key : Number] = ASCII code of the released key, or one of the PS.KEY_* constants documented in the API.\r\n[shift : Boolean] = true if shift key is held down, else false.\r\n[ctrl : Boolean] = true if control key is held down, else false.\r\n[options : Object] = A JavaScript object with optional data properties; see API documentation for details.\r\n*/\r\n\r\nPS.keyDown = function( key, shift, ctrl, options ) {\r\n\tplayer.listenForInput({ key, shift, ctrl, options });\r\n};\r\n\r\n/*\r\nPS.keyUp ( key, shift, ctrl, options )\r\nCalled when a key on the keyboard is released.\r\nThis function doesn't have to do anything. Any value returned is ignored.\r\n[key : Number] = ASCII code of the released key, or one of the PS.KEY_* constants documented in the API.\r\n[shift : Boolean] = true if shift key is held down, else false.\r\n[ctrl : Boolean] = true if control key is held down, else false.\r\n[options : Object] = A JavaScript object with optional data properties; see API documentation for details.\r\n*/\r\n\r\nPS.keyUp = function( key, shift, ctrl, options ) {\r\n\t// Uncomment the following code line to inspect first three parameters:\r\n\r\n\t// PS.debug( \"PS.keyUp(): key=\" + key + \", shift=\" + shift + \", ctrl=\" + ctrl + \"\\n\" );\r\n\r\n\t// Add code here for when a key is released.\r\n};\r\n\r\n/*\r\nPS.input ( sensors, options )\r\nCalled when a supported input device event (other than those above) is detected.\r\nThis function doesn't have to do anything. Any value returned is ignored.\r\n[sensors : Object] = A JavaScript object with properties indicating sensor status; see API documentation for details.\r\n[options : Object] = A JavaScript object with optional data properties; see API documentation for details.\r\nNOTE: Currently, only mouse wheel events are reported, and only when the mouse cursor is positioned directly over the grid.\r\n*/\r\n\r\nPS.input = function( sensors, options ) {\r\n\t// Uncomment the following code lines to inspect first parameter:\r\n\r\n//\t var device = sensors.wheel; // check for scroll wheel\r\n//\r\n//\t if ( device ) {\r\n//\t   PS.debug( \"PS.input(): \" + device + \"\\n\" );\r\n//\t }\r\n\r\n\t// Add code here for when an input event is detected.\r\n};\r\n\r\n"],"names":["DrawWallBead","x","y","DrawFloorBead","hasKey","floorData","DrawDoorBead","data","DrawFinalBead","registry","drawMap","map","cell","beadFunction","level1","StateMachine","name","stateFn","args","beadDrawFns","Keycode","getDrawFnResults","acc","fn","redrawBead","drawData","getDirectionFromKeycode","keycode","PlayerState","Sfx","Player","onWin","fsm","_tenantData","listening","drawAt","stateIdle","newX","newY","stateCheckMove","beadData","stateKeyPickup","stateHitWall","stateDoorInteraction","stateWin","stateMoving","ev","direction","sfxKey","player","system","options","key","shift","ctrl","sensors"],"mappings":"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"}